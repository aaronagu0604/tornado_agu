{% extends "weixin/none_foot_nav_tab.html" %}
{% block css %}
<title>选择收货地址、返佣方式</title>
<link rel="stylesheet" href="/style/mobile/swiper3.07.min.css">
<style>
    .parent {
        background-color: #F1F1F1;
    }

    .weui-cells__title {
        font-size: 17px;
        color: #000;
        background-color: #FFFFFF;
        margin-top: 5px;
        margin-bottom: 1px;
        padding-top: 10px;
        padding-bottom: 10px;
    }

    .default-addr {
        padding-left: 35px;
        padding-right: 20px;
        padding-bottom: 10px;
    }

    .write-addr {
        padding-left: 25px;
        padding-right: 10px;
        padding-bottom: 10px;
    }

    .gift_policy {
        background-color: #FFFFFF;
        margin-top: 5px;
    }

    .weui-col-50 {
        margin: auto;
        text-align: center
    }

    .weui-col-50 label {
        display: inline-flex;
    }

    .goto_next {
        background-color: #FFFFFF;
        padding: 20px;
    }

    .weui-cells weui-cells_checkbox hr {
        margin-left: 10px;
        margin-right: 10px;
        background-color: #F1F1F1;
    }

    .weui-cell__hd img {
        width: 22px;
        height: 22px;
    }

    .hr {
        width: 100%;
        height: 1px;
        background-color: #f1f1f1;
        margin-bottom: 5px;
    }

</style>
{% endblock %}
{% block content %}
<div class="parent">
    <div class="weui-cells__title">
        地址选择
    </div>
    <div class="weui-cells weui-cells_radio">
        <label class="weui-cell weui-check__label" for="default_addr">

            <div class="weui-cell__hd">
                <img src="../../style/wximg/duihao_gray.png" id="default_addr_img"/>
                <input type="radio" name="radio1" style="display: none" checked="checked" id="default_addr">
            </div>
            <div class="weui-cell__bd">
                <p> 默认地址</p>
            </div>
        </label>

        <div class="default-addr">
            <div class="hr">
            </div>
            <div class="weui-row">
                <div class="weui-row-50">
                    <p id="default_name">
                        {{address["delivery_to"]}}
                    </p>
                </div>
                <div class="weui-row-50">
                    <p id="default_tel">
                        {{address["delivery_tel"]}}
                    </p>

                </div>
            </div>
            <div class="weui-row">
                <p id="default_detailed_address">
                    {{address["delivery_province"]
                    +address["delivery_city"]
                    +address["delivery_district"]
                    +address["delivery_address"]}}
                </p>
            </div>

        </div>
        <label class="weui-cell weui-check__label" for="write_addr">

            <div class="weui-cell__hd">
                <img src="../../style/wximg/duihao_gray.png" id="write_addr_img"/>
                <input type="radio" name="radio1" style="display: none" id="write_addr">

            </div>
            <div class="weui-cell__bd">
                <p> 填写地址</p>
            </div>
        </label>

        <div class="write-addr">
            <p/>
            <div class="weui-cell">
                <div class="weui-label">收货人</div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="name" type="input" placeholder="请输入收货人姓名">
                </div>
            </div>
            <div class="weui-cell">
                <div class="weui-label">联系电话</div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="tel" type="input" placeholder="请输入收货人电话">
                </div>
            </div>
            <div class="weui-cell weui-cell">
                <div class="weui-cell__hd">
                    所在地区&#8195&#8195
                </div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="address" type="text" value="陕西省 西安市 碑林区" readonly>
                </div>
            </div>
            <div class="hr">
            </div>
            <div class="weui-cells__title">
                详细地址
            </div>
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <textarea class="weui-textarea" id="detailed_address" placeholder="请输入详细地址" rows="2"></textarea>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="gift_policy">
        <div class="weui-cells__title">
            <p>选择优惠方式</p>
        </div>
        <div class="weui-cells weui-cells_radio">
            <div class="weui-row">

                <div class="weui-col-50">
                    <label class="weui-cell weui-check__label" for="gift_policy_01">
                        <div class="weui-cell__hd">
                            <input type="radio" name="radio2" style="display: none" id="gift_policy_01">
                            <img src="../../style/wximg/duihao_gray.png" id="gift_policy_01_img"/>
                        </div>
                        <div class="weui-cell__bd">
                            <p> 返油</p>
                        </div>
                    </label>
                </div>


            </div>
        </div>
    </div>
    <div class="goto_next">
        <a href="#" onclick="gotoNext()" class="weui-btn weui-btn_primary">完成</a>
    </div>
</div>

{% endblock %}
{% block js %}
<script>
    $(document).ready(function () {
        if ($('#write_addr').is(':checked')) {
            $(".write-addr").show();
            $("#default_addr_img").attr('src', "../../style/wximg/duihao_gray.png");
            $("#write_addr_img").attr('src', "../../style/wximg/duihao_green.png");
        } else {
            $(".write-addr").hide();
            $("#default_addr_img").attr('src', "../../style/wximg/duihao_green.png");
            $("#write_addr_img").attr('src', "../../style/wximg/duihao_gray.png");

        }

        if ($('#gift_policy_01').is(':checked')) {
            $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_green.png");
        } else {
            $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_gray.png");
        }
        if ($('#gift_policy_02').is(':checked')) {
            $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_green.png");
        } else {
            $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_gray.png");
        }

        $(document).on("click", "#write_addr", function () {
            if ($('#write_addr').is(':checked')) {
                $(".write-addr").show();
                $("#default_addr_img").attr('src', "../../style/wximg/duihao_gray.png");
                $("#write_addr_img").attr('src', "../../style/wximg/duihao_green.png");
            } else {
                $(".write-addr").hide();
                $("#default_addr_img").attr('src', "../../style/wximg/duihao_green.png");
                $("#write_addr_img").attr('src', "../../style/wximg/duihao_gray.png");
            }
        });
        $(document).on("click", "#default_addr", function () {
            if ($('#default_addr').is(':checked')) {
                $(".write-addr").hide();
                $("#default_addr_img").attr('src', "../../style/wximg/duihao_green.png");
                $("#write_addr_img").attr('src', "../../style/wximg/duihao_gray.png");
            } else {
                $("#default_addr_img").attr('src', "../../style/wximg/duihao_gray.png");
                $("#write_addr_img").attr('src', "../../style/wximg/duihao_green.png");
            }
        });
        $(document).on("click", "#gift_policy_01", function () {
            if ($('#gift_policy_01').is(':checked')) {
                $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_green.png");
                $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_gray.png");
            } else {
                $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_gray.png");
                $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_green.png");
            }
        });
        $(document).on("click", "#gift_policy_02", function () {
            if ($('#gift_policy_02').is(':checked')) {
                $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_green.png");
                $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_gray.png");
            } else {
                $("#gift_policy_02_img").attr('src', "../../style/wximg/duihao_gray.png");
                $("#gift_policy_01_img").attr('src', "../../style/wximg/duihao_green.png");
            }
        });

        function gotoNext() {

            if (!$('#gift_policy_01').is(':checked') && !$('#gift_policy_02').is(':checked')) {
                $.toast("请选择优惠方式", "text");
            } else {
                var insurance = JSON.parse(window.localStorage.getItem("insurance"));

                if ($('#gift_policy_01').is(':checked')) {
                    insurance.gift_policy = "1";
                } else {
                    insurance.gift_policy = "2";
                }
                if (!$('#default_addr').is(':checked')) {
                    var tel = $("#tel").val();
                    var re = /^1\d{10}$/;
                    if ($("#name").val() == "") {
                        $.toast("请输入收货人姓名", "text");
                    } else if (tel == "") {
                        $.toast("请输入收货人电话", "text");
                    } else if (!re.test(tel)) {
                        $.toast("手机号格式错误", "text");
                    } else if ($("#detailed_address").val() == "") {
                        $.toast("请输入详细地址", "text");
                    } else {
                        window.localStorage.setItem("insurance", insurance);
                        document.location.href = "insurance_order_success";
                    }
                } else {
                    window.localStorage.setItem("insurance", insurance);
                    console.log(insurance);
                    document.location.href = "insurance_order_success";

                }

            }
        }

        $("#address").cityPicker({
            onChange: function (picker, values, displayValues) {
                console.log(values, displayValues)
            }
        });
    });

</script>
{% endblock %}